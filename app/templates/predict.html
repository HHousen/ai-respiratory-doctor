{% extends "layout.html" %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.css" integrity="sha256-e47xOkXs1JXFbjjpoRr1/LhVcqSzRmGmPqsrUQeVs+g=" crossorigin="anonymous" />
{% endblock %}
{% block scripts %}
    {{ super() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.js" integrity="sha256-cs4thShDfjkqFGk5s2Lxj35sgSRr4MRcyccmi0WKqCM=" crossorigin="anonymous"></script>
{% endblock %}
{% block content %}

<div class="container">
    <div class="section">
        <h1 class="center-align">AI Predictor</h1>
    </div>
</div>

<div class="container">
    <form class="dropzone" action="/predict-api" id="uploadFile" method="post" type="file" name="file" enctype="multipart/form-data">
        <div class="fallback">
            <input name="file" type="file" multiple />
        </div>
    </form>
    <table>
        <thead>
            <tr>
                <th>Category</th>
                <th>Percent</th>
            </tr>
        </thead>
        <tbody id="tbody">
        </tbody>
    </table>
</div>
{% endblock %}

{% block final %}
<script>
    Dropzone.options.uploadFile = {
        paramName: "file", // The name that will be used to transfer the file
        acceptedFiles: "image/*",
        maxFilesize: 2, // MB
        init: function() {
            this.on("success", function(file, data) {
                console.log('Success!' + data);
                $('#tbody').empty();
                jQuery.each(JSON.parse(data), function (key, value) {
                    var eachrow = "<tr>"
                                + "<td>" + key + "</td>"
                                + "<td>" + value + "</td>"
                                + "</tr>";
                    $('#tbody').append(eachrow);
                });
            });
        }
    };
    </script>
{% endblock %}